<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <title>Phoneme Transcoder</title>
    <link rel="stylesheet" href="index.css" type="text/css">
    <script src="util.js" type="text/javascript"></script>
  </head>
  <body>
    <details><summary> The Phoneme Transcoder translates word pronunciations from one
        phoneme encoding system to another. </summary>
      
      <details><summary><b> Source Layer </b></summary>
        
        <p> The <i> Source Layer </i> setting determines which layer includes labels whose
          encoding will be converted. </p>
      
      </details>
      <details><summary><b> Translation </b></summary>
        <p> This setting determines what encoding the source and destionation layers are
          assumed to have, for transcoding purposes. </p>
        <p> For example, if the <b>Source Layer</b> contains pronunciations encoded with
          CELEX DISC labels, and you want the <b>Destination Layer</b> to contain those
          pronunciations encoded using ARPAbet labels, select the <q>DISC → ARPAbet</q>
          as the <b>Translation</b>.</p>

        <details><summary>The built-in translations convert phonemes in one encoding to
            equivalent phonemes in another, where possible.</summary>

          <p>The following table presents some common encodings and equivalences or
            near-equivalences between phonemes.
            <a class="sdfootnoteanc" href="#sdfootnote209sym" name="sdfootnote209anc"><sup>1</sup></a></p>
          <table id="equiv" border="1" style="border-collapse: collapse;">
            <thead><tr>
                <th> Example </th>
                <th> IPA </th>
                <th> SAM-PA </th>
                <th> DISC<a class="sdfootnoteanc" href="#sdfootnote210sym" name="sdfootnote210anc"><sup>2</sup></a> </th>
                <th> CPA<a class="sdfootnoteanc" href="#sdfootnote211sym" name="sdfootnote211anc"><sup>3</sup></a> </th>
                <th> Kirshenbaum<a class="sdfootnoteanc" href="#sdfootnote212sym" name="sdfootnote212anc"><sup>4</sup></a> </th>
                <th> ARPAbet </th>
                <th> CMU Dict </th>
            </tr></thead><tbody>
              <tr><th colspan="8"> Vowels </th></tr>
              <tr><td> kit     </td><td> ɪ </td><td> I </td><td> I </td><td> I </td><td> I </td><td> IH </td><td> IH </td></tr>
              <tr><td> dress   </td><td> ɛ </td><td> <b>E</b> </td><td> E </td><td> E </td><td> E </td><td> EH </td><td> EH </td></tr>
              <tr><td> trap    </td><td> &aelig; </td><td> <b>{</b> </td><td> {</td><td> <b>^/</b> </td><td> <b>&amp;</b> </td><td> AE </td><td> AE </td></tr>
              <tr><td> strut   </td><td> ʌ </td><td> <b>V</b> </td><td> V </td><td> <b>^</b> </td><td> V </td><td> AH </td><td> AH </td></tr>
              <tr><td> foot    </td><td> ʊ </td><td> <b>U</b> </td><td> U </td><td> U </td><td> U </td><td> UH </td><td> UH </td></tr>
              <tr><td> <b>a</b>nother </td><td> ǝ </td><td> <b>@</b> </td><td> @ </td><td> @ </td><td> @ </td><td> AX </td><td> &nbsp; </td></tr>
              <tr><td> fleece  </td><td> iː </td><td> i: </td><td> i </td><td> i: </td><td> i: </td><td> IY </td><td> IY </td></tr>
              <tr><td> bath    </td><td> ɑː </td><td> <b>A:</b> </td><td> <b>#</b> </td><td> A: </td><td> <b>A:</b> </td><td> AA </td><td> AA </td></tr>
              <tr><td> lot     </td><td> ɒ </td><td> <b>Q</b> </td><td> Q </td><td> Q </td><td> <b>A.</b> </td> <td rowspan="2"> AO </td> <td rowspan="2"> AO </td></tr>
              <tr><td> thought </td><td> ɔː </td><td> <b>O:</b> </td><td> <b>$</b> </td><td> O: </td><td> O: </td></tr>
              <tr><td> goose   </td><td> uː </td><td> u: </td><td> u </td><td> u: </td><td> u: </td><td> UW </td><td> UW </td></tr>
              <tr><td> nurse   </td><td> ɜː </td><td> 3ː </td> <td> <b>3</b> </td><td> <b>@:</b> </td><td> <b>V&rdquo;</b> </td><td> ER </td><td> ER </td></tr>
              <tr><td> face    </td><td> eɪ </td><td> eI </td> <td> <b>1</b> </td><td> <b>e/</b> </td><td> eI </td><td> EY </td><td> EY </td></tr>
              <tr><td> price   </td><td> aɪ </td><td> aI </td> <td> <b>2</b> </td><td> <b>a/</b> </td><td> aI </td><td> AY </td><td> AY </td></tr>
              <tr><td> choice  </td><td> ɔɪ </td><td> <b>OI</b> </td> <td> <b>4</b> </td><td> <b>o/</b> </td><td> OI </td><td> OY </td><td> OY </td></tr>
              <tr><td> goat    </td><td> ǝʊ </td><td> <b>@U</b> </td> <td> <b>5</b> </td><td> <b>O/</b> </td><td> @U </td><td> OW </td><td> OW </td></tr>
              <tr><td> mouth   </td><td> aʊ </td><td> aU </td> <td> <b>6</b> </td><td> <b>A/</b> </td><td> aU </td><td> AW </td><td> AW </td></tr>
              <tr><td> near    </td><td> ɪǝ </td><td> <b>I@</b> </td> <td> <b>7</b> </td><td> <b>I/</b> </td><td> I@ </td><td> <i>IY R</i> </td><td> <i>IY R</i> </td></tr>
              <tr><td> square  </td><td> ɛǝ </td><td> <b>E@</b> </td> <td> <b>8</b> </td><td> <b>E/</b> </td><td> E@ </td><td> <i>EH R</i> </td><td> <i>EH R</i> </td></tr>
              <tr><td> cure    </td><td> ʊǝ </td><td> <b>U@</b> </td> <td> <b>9</b> </td><td> <b>U/</b> </td><td> U@ </td><td> <i>UH R</i> </td><td> <i>UH R</i> </td></tr>
              <tr><td> t<b>i</b>mbre </td><td> &aelig; </td><td> <b>{~</b> </td><td> <b>c</b> </td><td> <b>^/~</b> </td><td> <b>&amp;</b>~ </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> d&eacute;t<b>en</b>te </td><td> ɑ̃ː </td><td> <b>A~:</b> </td><td> <b>q</b> </td><td> <b>A~:</b> </td><td> A~: </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> l<b>in</b>gerie </td><td> &aelig;̃ː </td><td> <b>{~:</b> </td> <td> <b>0</b> </td><td> <b>^/~:</b> </td><td> <b>&amp;</b>~: </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> bouill<b>on</b> </td><td> ɒ̃ː </td><td> <b>O~:</b> </td><td> <b>~</b> </td><td> <b>O~:</b> </td><td> A.~: </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><th colspan="8"> Consonants </th></tr>
              <tr><td> <b>p</b>at      </td><td> p </td><td> p </td><td> p </td><td> p </td><td> p </td><td> P </td><td> P </td></tr>
              <tr><td> <b>b</b>ad      </td><td> b </td><td> b </td><td> b </td><td> b </td><td> b </td><td> B </td><td> B </td></tr>
              <tr><td> <b>t</b>ack     </td><td> t </td><td> t </td><td> t </td><td> t </td><td> t </td><td> T </td><td> T </td></tr>
              <tr><td> <b>d</b>ad      </td><td> d </td><td> d </td><td> d </td><td> d </td><td> d </td><td> D </td><td> D </td></tr>
              <tr><td> <b>c</b>ad      </td><td> k </td><td> k </td><td> k </td><td> k </td><td> k </td><td> K </td><td> K </td></tr>
              <tr><td> <b>g</b>ame     </td><td> g </td><td> g </td><td> g </td><td> g </td><td> g </td><td> G </td><td> G </td></tr>
              <tr><td> ba<b>ng</b>     </td><td> ŋ </td><td> <b>N</b> </td><td> <b>N</b> </td><td> <b>N</b> </td><td> N </td><td> NG </td><td> NG </td></tr>
              <tr><td> <b>m</b>ad      </td><td> m </td><td> m </td><td> m </td><td> m </td><td> m </td><td> M </td><td> M </td></tr>
              <tr><td> <b>n</b>at      </td><td> n </td><td> n </td><td> n </td><td> n </td><td> n </td><td> N </td><td> N </td></tr>
              <tr><td> <b>l</b>ad      </td><td> l </td><td> l </td><td> l </td><td> l </td><td> l </td><td> L </td><td> L </td></tr>
              <tr><td> <b>r</b>at      </td><td> r </td><td> r </td><td> r </td><td> r </td><td> r </td><td> R </td><td> R </td></tr>
              <tr><td> <b>f</b>at      </td><td> f </td><td> f </td><td> f </td><td> f </td><td> f </td><td> F </td><td> F </td></tr>
              <tr><td> <b>v</b>at      </td><td> v </td><td> v </td><td> v </td><td> v </td><td> v </td><td> V </td><td> V </td></tr>
              <tr><td> <b>th</b>in     </td><td> Ɵ </td><td> <b>T</b> </td><td> T </td><td> T </td><td> T </td><td> TH </td><td> TH </td></tr>
              <tr><td> <b>th</b>en     </td><td> &eth; </td><td> <b>D</b> </td><td> D </td><td> D </td><td> D </td><td> DH </td><td> DH </td></tr>
              <tr><td> <b>s</b>ap      </td><td> s </td><td> s </td><td> s </td><td> s </td><td> s </td><td> S </td><td> S </td></tr>
              <tr><td> <b>z</b>ap      </td><td> z </td><td> z </td><td> z </td><td> z </td><td> z </td><td> Z </td><td> Z </td></tr>
              <tr><td> <b>sh</b>eep    </td><td> ʃ </td><td> <b>S</b> </td><td> S </td><td> S </td><td> S </td><td> SH </td><td> SH </td></tr>
              <tr><td> mea<b>s</b>ure  </td><td> Ʒ </td><td> <b>Z</b> </td><td> Z </td><td> Z </td><td> Z </td><td> ZH </td><td> ZH </td></tr>
              <tr><td> <b>y</b>ank     </td><td> j </td><td> j </td><td> j </td><td> j </td><td> j </td><td> Y </td><td> Y </td></tr>
              <tr><td> <b>h</b>ad      </td><td> h </td><td> h </td><td> h </td><td> h </td><td> h </td><td> HH </td><td> HH </td></tr>
              <tr><td> <b>w</b><span>et</span> </td><td> w </td><td> w </td><td> w </td><td> w </td><td> w </td><td> W </td><td> W </td></tr>
              <tr><td> <b>ch</b>eap    </td><td> ʧ </td><td> tS </td><td> <b>J</b> </td><td> <b>T/</b> </td><td> tS </td><td> CH </td><td> CH </td></tr>
              <tr><td> <b>j</b>eep     </td><td> ʤ </td><td> dZ </td><td> <b>_</b> </td><td> <b>J/</b> </td><td> dZ </td><td> JH </td><td> JH </td></tr>
              <tr><td> lo<b>ch</b>     </td><td> x </td><td> x </td><td> x </td><td> x </td><td> x </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> baco<b>n</b>    </td><td> ŋ̩ </td><td> <b>N,</b> </td><td> <b>C</b> </td><td> N, </td><td> <b>N-</b> </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> idealis<b>m</b> </td><td> m̩ </td><td> <b>m,</b> </td><td> <b>F</b> </td><td> m, </td><td> <b>m-</b> </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> burde<b>n</b>   </td><td> n̩ </td><td> <b>n,</b> </td><td> <b>H</b> </td><td> n, </td><td> <b>n-</b> </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> dang<b>l</b>e   </td><td> l̩ </td><td> <b>l,</b> </td><td> <b>P</b> </td><td> l, </td><td> <b>l-</b> </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> ca<b>r</b> alarm </td><td> * </td><td> <b>r*</b> </td><td> <b>R</b> </td><td> r* </td><td> &nbsp; </td><td> &nbsp; </td><td> &nbsp; </td></tr>
              <tr><td> uh<b>-</b>oh    </td><td> ʔ </td><td> <b>?</b> </td><td> &nbsp; </td><td> &nbsp; </td><td> ? </td><td> Q </td><td> &nbsp; </td> </tr>
              <tr><td> fathe<b>r</b>   </td><td> ɚ </td><td> &nbsp; </td><td> &nbsp; </td><td> &nbsp; </td><td> &nbsp; </td><td> AXR </td><td> &nbsp; </td></tr>
              <tr><td> we<b>tt</b>er   </td><td> ɾ </td><td> &nbsp; </td><td> &nbsp; </td><td> &nbsp; </td><td> &nbsp; </td><td> DX </td><td> &nbsp; </td></tr>
          </tbody></table>
          
          <div id="sdfootnote209">
            <p class="sdfootnote">
              <sup><a class="sdfootnotesym" href="#sdfootnote209anc" name="sdfootnote209sym">1</a></sup> 
              In the table, some phoneme representations are highlighted with
              a <b>bold</b> typeface; this highlighting is intended to indicate
              representations that are unpredictable in some way, either because they're
              substantially different from IPA or from English orthographical convention,
              or they're different from the corresponding representation in an
              otherwise-similar set of representations. Others are highlighted with
              an <i>italic</i> typeface; these are examples of representations that
              actually use a combination of two phonemes, where in other sets only one
              phoneme is used.</p>  
          </div>
          
          <div id="sdfootnote210">
            <p class="sdfootnote">
              <sup><a class="sdfootnotesym" href="#sdfootnote210anc" name="sdfootnote210sym">2</a></sup>
              SAM-PA and DISC phonemes taken from CELEX English Guide (1995) 
              &sect; 2.4.1 pp. 31-32, Tables 3 &amp; 4.</p> 
          </div>
          
          <div id="sdfootnote211">
            <p class="sdfootnote">
              <sup><a class="sdfootnotesym" href="#sdfootnote211anc" name="sdfootnote211sym">3</a></sup> 
              The Computer Phonetic Alphabet (CPA) was developed for seven European
              languages, based on the IPA - Kugler-Kruse (1987)</p> 
          </div>
          
          <div id="sdfootnote212">
            <p class="sdfootnote">
              <sup><a class="sdfootnotesym" href="#sdfootnote212anc" name="sdfootnote212sym">4</a></sup>
              <a href="http://en.wikipedia.org/wiki/Kirshenbaum">http://en.wikipedia.org/wiki/Kirshenbaum</a></p>
          </div>
        </details>
        
        <p> If you select the option <q>Custom Translation</q>, then you can specify an arbitrary
          list of <b>Mappings</b> from the <b>Source Layer</b> label characters to
          the <b>Destination Layer</b> characters.</p>

        <details><summary><b> Mappings </b></summary>
          
          <p> If you select the <q>Custom Translation</q> option, you can specify a list
            of <b>Mappings</b> - a list of characters to match against, which starts off
            empty. </p> 
          
          <p> To add a mapping, click the + button on the right hand side. </p>
          
          <p> To remove a mapping, select it in the list and click the - button on the right
            hand side. </p>
          
          <p> The <b>Source Characters</b> column contains the characters that will be
            applied to the source layer annotation labels. If one of the rows matches a
            character or sequence of characters on the source layer, then the
            corresponding value from the <b>Destination Characters</b> column is copied
            to the resulting label on the destination layer. </p>

          <p> For example, if you add a mapping <q>ng → ŋ</q>, then all instances
            of <q>ng</q> on the source layer will be translated as <q>ŋ</q> on the
            destination layer.</p>

          <p> The characters are checked in the order you specify.  You can move a pattern up or
            down in the order by selecting it and using the <big>&uarr;</big>
            and <big>&darr;</big> buttons on the right. </p>
      
          <p> For characters in the source layer that don't match any value in the Source
            Characters column, the <b>Characters with no mapping</b> setting determines
            whether they are copied as-is, or ignored.</p>

        </details>
        
      </details>
      <details><summary><b> Destination Layer </b></summary>
        <p> This is the layer that new annotations will be added to. You can pick an
          existing layer, or add a new layer. </p>
      </details>
      <details><summary><b> Language </b></summary>
        
        <p> The <i>Language</i> setting determines which language to target for
          annotation. Leave this blank to ignore language, or enter an ISO language/locale code,
          e.g. <tt> en-NZ </tt>, to target varieties of a particular language. This setting is
          treated as a regular expression, so <tt> es.*</tt> will target all varietys of
          Spanish, etc. </p>  
        
        <p>If you specify a language, then only utterances in the language specified will be
          annotated. There are three factors that determine the language of an utterance:</p> 
        <ol>
          <li> The text may be language-tagged - i.e. be enclosed by an annotation on
            the layer selected for <b> Phrase Language Layer </b>. </li> 
          <li> If not, the layer selected for <b> Transcript Language Attribute </b> is
            used to determine the language.</li>  
          <li> If the transcript has no language otherwise explicitly specified, then the
            language of the corpus is assumed.</li> 
        </ol>
        
      </details>
    </details>

    <hr>
    
    <form method="POST" action="setTaskParameters" id="form">
      <div class="field" title="Input layer from which words come">
        <label for="sourceLayerId">Source Layer</label>
        <span><select id="sourceLayerId" name="sourceLayerId" required>
            <option disabled>[select layer]</option> <!-- force choice the first time -->
        </select></span>
        <span class="example" id="sourceExample" title="Example source layer"></span>
      </div>

      <div class="field" title="Output layer on which new annotations are added">
        <label for="translation">Translation</label>
        <span>
          <select id="translation" name="translation" required>
            <option disabled>[select translation]</option> <!-- force choice the first time -->
            <option value="DISC2CMU">DISC → CMU</option>
            <option value="CMU2DISC">CMU → DISC</option>
            <option value="DISC2ARPAbet">DISC → ARPAbet</option>
            <option value="ARPAbet2DISC">ARPAbet → DISC</option>
            <option value="DISC2Unisyn">DISC → Unisyn</option>
            <option value="Unisyn2DISC">Unisyn → DISC</option>
            <option value="DISC2Kirshenbaum">DISC → Kirshenbaum</option>
            <option value="Kirshenbaum2DISC">Kirshenbaum → DISC</option>
            <option value="DISC2SAMPA">DISC → SAMPA</option>
            <option value="SAMPA2DISC">SAMPA → DISC</option>
            <option value="DISC2XSAMPA">DISC → XSAMPA</option>
            <option value="XSAMPA2DISC">XSAMPA → DISC</option>
            <option value="DISC2IPA">DISC → IPA</option>
            <option value="custom">Custom Translation</option>
          </select>
        </span>
        <span class="example" id="translationExample">↓</span>
      </div>
      
      <div class="field" title="Output layer on which new annotations are added">
        <label for="destinationLayerId">Destination Layer</label>
        <span>
          <select id="destinationLayerId" name="destinationLayerId" required>
            <option disabled>[select layer]</option> <!-- force choice the first time -->
            <option>[add layer]</option>             <!-- allow adding a new layer -->
          </select>
        </span>
        <span class="example" id="destinationExample" title="Example destination layer"></span>
      </div>
      
      <div id="mappingsDiv">
        <h4>Mappings</h4>
        <div id="mappings"></div>
        <div id="controls">
          <div id="add" style="display: table-row;">
	    <button id="addButton"
                    title="Add a mapping">
	      <img src="add.svg" alt="add" />
	    </button>
          </div>
          <div id="up" style="display: table-row;">
	    <button id="upButton"
                    title="Move selected mapping up (match it earlier)">
	      <img src="up.svg" alt="up" />
	    </button>
          </div>
          <div id="down" style="display: table-row;">
	    <button id="downButton" 
		    title="Move selected mapping down (match it later)">
	      <img src="down.svg" alt="down" />
	    </button>
          </div>
          <div id="remove" style="display: table-row;">
	    <button id="removeButton"
		    title="Remove selected mapping">
	      <img src="remove.svg" alt="remove" />
	    </button>
          </div>
        </div>
        <div id="nomapping"
             title="If the source layer annotation matches no mapping, then any pre-existing annotation in the target layer should be...">
          <label for="copyCharacters">Characters with no mapping should be</label>
          <span>
            <select name="copyCharacters" id="copyCharacters">
	      <option value="true">copied</option>
	      <option value="false">ignored</option>
            </select>
          </span>
        </div>
      </div><!-- mappingsDiv -->

      <div class="field language-field"
           id="languageField"
           title="Regular expression for the ISO language codes of the languages to target, or blank for all">
        <label for="language">Language</label>
        <span><input id="language" name="language" type="text" placeholder="Language"></span>
      </div>
      <div class="field language-field" title="Transcript attribute for overall language">
        <label for="transcriptLanguageLayerId">Transcript Language Attribute</label>
        <span>
          <select id="transcriptLanguageLayerId" name="transcriptLanguageLayerId">
            <option value="">[none]</option>
          </select>
        </span>
      </div>
      <div class="field language-field"
           title="Layer for annotating phrases in a different language">
        <label for="phraseLanguageLayerId">Phrase Language Layer</label>
        <span>
          <select id="phraseLanguageLayerId" name="phraseLanguageLayerId">
            <option value="">[none]</option>
          </select>
        </span>
      </div>
      
      <div class="controls"><input type="submit" value="Set Parameters"></div>
    </form>
    
    <footer><div> Phoneme Transcoder <small id="version"></small> </div></footer>
    <script src="index.js" type="text/javascript"></script>
  </body>
</html>
