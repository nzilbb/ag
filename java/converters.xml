<?xml version="1.0" encoding="utf-8"?>
<project name="converters" default="all" basedir=".">
  <description>Format conversion utilities using nzilbb.ag</description>
  <!-- set global properties for this build -->
  <property name="src"   location="."/>
  <property name="build" location="build_${ant.project.name}"/>
  <property name="dist"  location="../bin"/>
  
  <target name="all" depends="serializations,vtt-to-textgrid">
  </target>

  <target name="serializations">
    <ant antfile="praat.xml" />
    <ant antfile="webvtt.xml" />
  </target>

  <target name="vtt-to-textgrid"
          description="VTT to TextGrid converter" >
    <mkdir dir="${build}"/>

    <!-- Compile the java code from ${src} into ${build} -->
    <javac srcdir="${src}" destdir="${build}"
	   classpath="${dist}/nzilbb.ag.jar;${dist}/nzilbb.webvtt.jar;${dist}/nzilbb.praat.jar"
	   includes="nzilbb/converter/VttToTextGrid.java"
	   listfiles="yes"
	   includeantruntime="false"
	   target="6" source="6"
	   debug="on"
	   >
      <compilerarg value="-Xlint"/>
    </javac>
    
    <!-- Put everything in ${build} into the ${ant.project.name}.jar file -->
    <jar jarfile="${dist}/vtt-to-textgrid.jar" 
	 basedir="${build}">
      <manifest>
	<attribute name="Application-Name" value="VTT to TextGrid Converter"/>
	<attribute name="Permissions" value="all-permissions"/>
	<attribute name="Main-Class" value="nzilbb.converter.VttToTextGrid"/>
      </manifest>
      
      <!-- add required jars -->
      <zipfileset src="${dist}/nzilbb.ag.jar" />
      <zipfileset src="${dist}/nzilbb.webvtt.jar" />
      <zipfileset src="${dist}/nzilbb.praat.jar" />
      
    </jar>
    
    <delete dir="${build}"/>
  </target>
  
</project>
